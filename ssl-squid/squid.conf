# WELCOME TO THE CONFIG FILE -- LOOK UP DOCUMENTATION ONLINE #

# --- AUTH PARAMETERS --- #
#auth_param digest program /usr/lib/squid3/digest_pw_auth -c /etc/squid3/passwd
#auth_param digest realm squidRealm
#auth_param digest children 4

# --- ACL --- #
#acl localhost src 127.0.0.1/32 ::1
#acl to_localhost dst 127.0.0.0/8 0.0.0.0/32 ::1

acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl SSL_ports port 443	
acl port_443 port 443
acl CONNECT method CONNECT


http_access deny !Safe_ports
http_access deny CONNECT !SSL_Ports

# --- EXPIREMENTAL ACL SECTION --- #
# use the following lines to debug acl's using tail -f on cache.log
#debug_options ALL,1 28,3

always_direct allow all
#ssl_bump server-first all

# need to make this an opt-in per user configuration
acl google_url dstdomain .google.com
ssl_bump server-first google_url


# On unix-based systems the ability to include an entire folders worth of files is provided.
include /etc/squid3/userACLs/*.conf

# --- END EXPIREMENTAL ACL SECTION --- #

cache deny all
#http_access allow auth_users all
#http_access allow localhost
http_access deny all

# --- HTTP PORTS ---#
#http_port 3128
#this section is now nested inside [user].conf

# --- DNS NAMESERVERS --- #
dns_nameservers 8.8.8.8 8.8.4.4

# --- LOGFORMAT --- #
logformat dougs_log_format referrer:"%{Referer}>h" username:%un identUsername:%ui authUsername:%ul reqStatus:%Ss reqVersion:%rv reqMethod:%rm clientSourceIP:%>a MIME-Type:%mt ReqURL:%ru UserAgent:"%{User-Agent}>h" ClientSourcePort:%>p
logformat mysql_log_format  (%lp, "%Ss", "%mt", "%{Host}>h", "%>ru", "%>a", %ts.%03tu, "%{%Y-%m-%d}tg", "%{%H:%M:%S}tg", "%06tu",  "%{User-Agent}>h", %<st, "%>A", "%<A", "%>h"),

# --- ACCESS LOG --- #
access_log /var/log/squid3/access.log dougs_log_format
access_log /var/log/squid3/mysql/mysql.log mysql_log_format

# --- CACHE LOG --- #
cache_log /var/log/squid3/cache/cache.log

# --- COREDUMP --- #
coredump_dir /var/spool/squid3

# --- REFRESH PATTERN --- #
#refresh_pattern ^ftp:           1440    20%     10080
#refresh_pattern ^gopher:        1440    0%      1440
#refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
#refresh_pattern .               0       20%     4320